<!-- RSS 1.0 export -->
<metal:block define-macro="export_rss_1_0"
  tal:define="export_script nocall:here/cpsportlet_export_rss_1_0">
  <metal:block use-macro="here/cpsportlet_macros/macros/syndication" />
</metal:block>

<!-- RSS 2.0 export -->
<metal:block define-macro="export_rss_2_0"
  tal:define="export_script nocall:here/cpsportlet_export_rss_2_0">
  <metal:block use-macro="here/cpsportlet_macros/macros/syndication" />
</metal:block>

<!-- ATOM 0.3 export -->
<metal:block define-macro="export_atom_0_3"
  tal:define="export_script nocall:here/cpsportlet_export_atom_0_3">
  <metal:block use-macro="here/cpsportlet_macros/macros/syndication" />
</metal:block>

<!-- Not implemented or unknown export format-->
<metal:block define-macro="export_not_implemented">
  <strong tal:content="export" />:
  <span i18n:translate="">this export format has not been implemented yet</span>.
</metal:block>

<!-- Syndication -->
<metal:block define-macro="syndication">
  <tal:block define="url string:${request/URL}?export=${export};
                     utool nocall:here/portal_url;
                     portal python: utool.getPortalObject()"
   content="structure python: export_script(portal=portal, box=ds, items=items, url=url, context=here, request=request)" />
</metal:block>

<!-- Display export buttons -->
<metal:block define-macro="xml_exports"
  tal:define="formats ds/syndication_formats;
              short_syndication_formats ds/short_syndication_formats|nothing;
              portlet nocall:options/portlet|nothing"
  tal:condition="python: formats and portlet">
  <div class="xmlExportButtons"
  tal:define="vtool here/portal_vocabularies;
              voc vtool/cpsportlets_syndication_formats_voc">
    <tal:block repeat="format formats">
      <a
      i18n:attributes="title"
      tal:omit-tag="not:voc/?format|nothing"
      tal:attributes="href string:${portlet/absolute_url}?export=${format};
                      title string:cpsportlets_syndication_${format}_help">
        <tal:block condition="short_syndication_formats"
         content="voc/?format|nothing" />
        <tal:block condition="not:short_syndication_formats"
         i18n:translate=""
         content="python:voc.getMsgid(key=format)" />
      </a>
    </tal:block>
  </div>
  <div style="clear:right"></div>
</metal:block>
