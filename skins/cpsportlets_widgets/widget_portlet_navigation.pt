<tal:block define="utool nocall:here/portal_url;
                   ds options/datastructure;
                   display ds/display;
                   context nocall:options/context_obj|here;
                   context_url python: context.absolute_url(1);
                   context_rpath python: utool.getRelativeUrl(context)">
  <tal:block condition="python: display == 'vertical_breadcrumbs_menu'"
   define="rel_depth ds/rel_depth;
           trailItems python: context.getBreadcrumbsItems(url=context_url);
           navItems python: context.getNavigationItems(context_obj=context, prefix=context_rpath, only_children=1);
           trailItems python: trailItems[int(rel_depth):];
           depth python: len(trailItems)">
    <h1 style="margin:0" tal:condition="python: depth >= 1">
      <a tal:define="item python: trailItems[0]"
         tal:attributes="href item/url"
         tal:content="item/title" /><br/>
      <tal:block tal:repeat="item navItems" tal:condition="python: depth == 1">
        <br/><a tal:content="item/title" tal:attributes="href item/url" />
      </tal:block>
    </h1>
    <h2 style="margin:0" tal:condition="python: depth >= 2">
      <a tal:define="item python: trailItems[1]"
         tal:attributes="href item/url"
         tal:content="item/title" /><br/>
      <tal:block tal:repeat="item navItems" tal:condition="python: depth == 2">
        <br/><a tal:content="item/title" tal:attributes="href item/url" />
      </tal:block>
    </h2>
    <h3 style="margin:0" tal:condition="python: depth >= 3">
      <a tal:define="item python: trailItems[2]"
         tal:attributes="href item/url"
         tal:content="item/title" /><br/>
      <tal:block tal:repeat="item navItems" tal:condition="python: depth == 3">
        <br/><a tal:content="item/title" tal:attributes="href item/url" />
      </tal:block>
    </h3>
    <tal:block repeat="level python: range(3,depth)">
      <h4 style="margin:0">
        <a tal:define="item python: trailItems[level]"
           tal:attributes="href item/url"
           tal:content="item/title" /><br/>
        <tal:block tal:repeat="item navItems" tal:condition="python: level == depth">
          <br/><a tal:content="item/title" tal:attributes="href item/url" />
        </tal:block>
      </h4>
    </tal:block>
  </tal:block>
</tal:block>
