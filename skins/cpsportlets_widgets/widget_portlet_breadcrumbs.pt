<tal:block define="ds options/datastructure;
                   display ds/display;
                   display_hidden_folders ds/display_hidden_folders;
                   display_site_root ds/display_site_root;
                   highlight_last_item ds/highlight_last_item;
                   highlight_last_item python:int(highlight_last_item);
                   first_item ds/first_item;
                   context nocall:options/context_obj|here;
                   utool nocall:here/portal_url;
                   context_url python: utool.getRelativeUrl(context);
                   base_url python: request.get('cpsskins_base_url');
                   breadcrumbsItems python: context.getBreadcrumbsItems(context=context, display_hidden_folders=display_hidden_folders, first_item=first_item, display_site_root=display_site_root)">
  <form tal:condition="python: display == 'dropdown_list'"
  method="get" action="cpsportlet_url_redirect"
  tal:attributes="action string:${context_url}/cpsportlet_url_redirect">
    <select onchange="submit()" name="url" tal:condition="breadcrumbsItems">
      <tal:block repeat="item breadcrumbsItems">
        <option value="" selected=""
        tal:define="item_url item/url"
        tal:content="python: item['title']"
        tal:attributes="value item_url;
                        selected python:test(item_url == context_url, nothing, 'selected')" />
      </tal:block>
    </select>
  </form>
  <tal:block condition="python: display == 'horizontal_trail'">
    <tal:comment condition="nothing">
      the icon should be made optional, e.g. with a "show icon" option
    </tal:comment>
    <img tal:attributes="src
      string:${base_url}cpsskins_images/UpFolder_icon.png;
      alt string:Up Folder" />
    <tal:block repeat="item breadcrumbsItems">
      <tal:block define="last_item repeat/item/end">
        <strong tal:omit-tag="python: not (highlight_last_item and last_item)">
        <a href="" tal:attributes="href item/url;
                                   title item/longtitle"
         tal:content="python: item['title']" />
        </strong>
        <tal:block condition="not:last_item"
         content="structure string:&gt;" />
      </tal:block>
    </tal:block>
  </tal:block>
</tal:block>
